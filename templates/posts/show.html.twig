{% extends 'base.html.twig' %}


{% block title %}Post {{ posts.id }}{% endblock %}

{% block body %}
    <div class="page-header">
        <h4 class="page-title">Post {{ posts.id }}</h4>
    </div> <br/>
    <div class="card" style="">
    <div class="card-body" >
    <table class="table">
    <br/>
        {% if posts.user.visible == 1 %}
    <tbody>
    <tr>
        <th>Name</th>
        <td>{{ posts.user.name }}</td>
    </tr>

    <tr>
        <th>Text</th>
        <td>{{ posts.text }}</td>
    </tr>

    <tr>
        <th>Link</th>
        <td>
            {% if posts.link == true %}
                <iframe width="50%" height="100%"
                        src="{{ posts.link }}">
                </iframe> <br/>
            {% endif %}
        </td>
    </tr>

    <tr>
        <th>Date/Time</th>
        <td>{{ posts.created ? posts.created|date('Y-m-d H:i:s') }}</td>
    </tr>
    </tbody>
    </table>
<br/>
    <table>
        <tbody>
        <tr>
        <th>Replies:</th>
        </tr>
            {% for replies in posts.replies %}
                <tr>
        <td><img src="{{ asset('images/profilepictures/' ~ replies.user.profilepicture) }}" alt="No profile picture found." style="max-width: 75px; max-height:75px;"></td>
        <td>{{ replies.user.name }}:</td>
        <td>{{ replies.text }}</td>
            {% endfor %}
        </tr>
        </tbody>
    </table>
    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div class="{{ label }}">{{ message }}</div>
        {% endfor %}
    {% endfor %}
    <br/>
        <table>
            <tbody>
            <tr>
                <th>This post is liked by:</th>
            </tr>
    {% for likes in posts.likes %}
            <tr>
                <td><img src="{{ asset('images/profilepictures/' ~ likes.user.profilepicture) }}" alt="No profile picture found." style="max-width: 75px; max-height:75px;"> {{ likes.user.username}} </td>
    {% endfor %}
            </tr>
            </tbody>
        </table>
    {% if app.user.liked(posts) == true %}
        <form action="{{ path('Unlike', {'id': posts.id}) }}">
            <button type="submit" value="like"><i class="fas fa-thumbs-up"></i> Unlike this post</button>
        <br>
    {% else %}
            <form action="{{ path('Like', {'id': posts.id}) }}">
                <button type="submit" value="like"><i class="fas fa-thumbs-up"></i> Like this post</button>
            <br>
    {% endif %}

    <h1>Create a new Reply</h1>
    <a href="{{ path('replies_new', {'id': posts.id}) }}">New reply</a> <br/>
    </form>
    <br>
        </form>
    </div>
    </div>
    {% else %}
    This post's user is hidden, so you cannot interact with this post unless you're friends with them.
    {% endif %}
{% endblock %}